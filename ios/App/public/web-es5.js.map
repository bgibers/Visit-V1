{"version":3,"sources":["webpack:///node_modules/@capacitor/camera/dist/esm/web.js"],"names":["CameraWeb","options","Promise","resolve","reject","webUseInput","fileInputExperience","customElements","get","cameraModal","document","createElement","body","appendChild","componentOnReady","addEventListener","e","photo","detail","Error","_getCameraPhoto","dismiss","removeChild","present","console","error","input","querySelector","cleanup","_a","parentNode","id","type","accept","capture","source","Photos","Prompt","removeAttribute","direction","Front","Rear","_e","file","files","format","resultType","reader","FileReader","dataUrl","result","b64","split","base64String","readAsDataURL","webPath","URL","createObjectURL","click","onloadend","r","onerror","navigator","permissions","unavailable","window","query","name","permission","camera","state","photos","unimplemented","Camera"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAEaA,S;;;;;;;;;;;;;;oGACMC,O;;;;;;;sDAEJ,IAAIC,OAAJ;AAAA,yFAAY,kBAAOC,OAAP,EAAgBC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCACXH,OAAO,CAACI,WADG;AAAA;AAAA;AAAA;;AAEX,qCAAI,CAACC,mBAAL,CAAyBL,OAAzB,EAAkCE,OAAlC;;AAFW;AAAA;;AAAA;AAAA,qCAKPI,cAAc,CAACC,GAAf,CAAmB,kBAAnB,CALO;AAAA;AAAA;AAAA;;AAMDC,2CANC,GAMaC,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CANb;AAOPD,wCAAQ,CAACE,IAAT,CAAcC,WAAd,CAA0BJ,WAA1B;AAPO;AAAA;AAAA,uCASGA,WAAW,CAACK,gBAAZ,EATH;;AAAA;AAUHL,2CAAW,CAACM,gBAAZ,CAA6B,SAA7B;AAAA,sGAAwC,iBAAOC,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAC9BC,iDAD8B,GACtBD,CAAC,CAACE,MADoB;;AAAA,kDAEhCD,KAAK,KAAK,IAFsB;AAAA;AAAA;AAAA;;AAGhCb,kDAAM,CAAC,IAAI,kEAAJ,CAAuB,2BAAvB,CAAD,CAAN;AAHgC;AAAA;;AAAA;AAAA,kDAK3Ba,KAAK,YAAYE,KALU;AAAA;AAAA;AAAA;;AAMhCf,kDAAM,CAACa,KAAD,CAAN;AANgC;AAAA;;AAAA;AAAA,0DAShCd,OATgC;AAAA;AAAA,mDASlB,KAAI,CAACiB,eAAL,CAAqBH,KAArB,EAA4BhB,OAA5B,CATkB;;AAAA;AAAA;AAAA;;AAAA;AAWpCQ,uDAAW,CAACY,OAAZ;AACAX,oDAAQ,CAACE,IAAT,CAAcU,WAAd,CAA0Bb,WAA1B;;AAZoC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAAxC;;AAAA;AAAA;AAAA;AAAA;AAcAA,2CAAW,CAACc,OAAZ;AAxBG;AAAA;;AAAA;AAAA;AAAA;;AA2BH,qCAAI,CAACjB,mBAAL,CAAyBL,OAAzB,EAAkCE,OAAlC;;AA3BG;AAAA;AAAA;;AAAA;AA+BPqB,uCAAO,CAACC,KAAR;;AACA,qCAAI,CAACnB,mBAAL,CAAyBL,OAAzB,EAAkCE,OAAlC;;AAhCO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAAZ;;AAAA;AAAA;AAAA;AAAA,wB;;;;;;;;;;;;;;;;;;4CAqCSF,O,EAASE,O,EAAS;AAClC,cAAIuB,KAAK,GAAGhB,QAAQ,CAACiB,aAAT,CAAuB,0BAAvB,CAAZ;;AACA,cAAMC,OAAO,GAAG,SAAVA,OAAU,GAAM;AAClB,gBAAIC,EAAJ;;AACA,aAACA,EAAE,GAAGH,KAAK,CAACI,UAAZ,MAA4B,IAA5B,IAAoCD,EAAE,KAAK,KAAK,CAAhD,GAAoD,KAAK,CAAzD,GAA6DA,EAAE,CAACP,WAAH,CAAeI,KAAf,CAA7D;AACH,WAHD;;AAIA,cAAI,CAACA,KAAL,EAAY;AACRA,iBAAK,GAAGhB,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAR;AACAe,iBAAK,CAACK,EAAN,GAAW,yBAAX;AACAL,iBAAK,CAACM,IAAN,GAAa,MAAb;AACAtB,oBAAQ,CAACE,IAAT,CAAcC,WAAd,CAA0Ba,KAA1B;AACH;;AACDA,eAAK,CAACO,MAAN,GAAe,SAAf;AACAP,eAAK,CAACQ,OAAN,GAAgB,IAAhB;;AACA,cAAIjC,OAAO,CAACkC,MAAR,KAAmB,0DAAaC,MAAhC,IACAnC,OAAO,CAACkC,MAAR,KAAmB,0DAAaE,MADpC,EAC4C;AACxCX,iBAAK,CAACY,eAAN,CAAsB,SAAtB;AACH,WAHD,MAIK,IAAIrC,OAAO,CAACsC,SAAR,KAAsB,6DAAgBC,KAA1C,EAAiD;AAClDd,iBAAK,CAACQ,OAAN,GAAgB,MAAhB;AACH,WAFI,MAGA,IAAIjC,OAAO,CAACsC,SAAR,KAAsB,6DAAgBE,IAA1C,EAAgD;AACjDf,iBAAK,CAACQ,OAAN,GAAgB,aAAhB;AACH;;AACDR,eAAK,CAACX,gBAAN,CAAuB,QAAvB,EAAiC,UAAC2B,EAAD,EAAQ;AACrC,gBAAMC,IAAI,GAAGjB,KAAK,CAACkB,KAAN,CAAY,CAAZ,CAAb;AACA,gBAAIC,MAAM,GAAG,MAAb;;AACA,gBAAIF,IAAI,CAACX,IAAL,KAAc,WAAlB,EAA+B;AAC3Ba,oBAAM,GAAG,KAAT;AACH,aAFD,MAGK,IAAIF,IAAI,CAACX,IAAL,KAAc,WAAlB,EAA+B;AAChCa,oBAAM,GAAG,KAAT;AACH;;AACD,gBAAI5C,OAAO,CAAC6C,UAAR,KAAuB,SAAvB,IAAoC7C,OAAO,CAAC6C,UAAR,KAAuB,QAA/D,EAAyE;AACrE,kBAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;AACAD,oBAAM,CAAChC,gBAAP,CAAwB,MAAxB,EAAgC,YAAM;AAClC,oBAAId,OAAO,CAAC6C,UAAR,KAAuB,SAA3B,EAAsC;AAClC3C,yBAAO,CAAC;AACJ8C,2BAAO,EAAEF,MAAM,CAACG,MADZ;AAEJL,0BAAM,EAANA;AAFI,mBAAD,CAAP;AAIH,iBALD,MAMK,IAAI5C,OAAO,CAAC6C,UAAR,KAAuB,QAA3B,EAAqC;AACtC,sBAAMK,GAAG,GAAGJ,MAAM,CAACG,MAAP,CAAcE,KAAd,CAAoB,GAApB,EAAyB,CAAzB,CAAZ;AACAjD,yBAAO,CAAC;AACJkD,gCAAY,EAAEF,GADV;AAEJN,0BAAM,EAANA;AAFI,mBAAD,CAAP;AAIH;;AACDjB,uBAAO;AACV,eAfD;AAgBAmB,oBAAM,CAACO,aAAP,CAAqBX,IAArB;AACH,aAnBD,MAoBK;AACDxC,qBAAO,CAAC;AACJoD,uBAAO,EAAEC,GAAG,CAACC,eAAJ,CAAoBd,IAApB,CADL;AAEJE,sBAAM,EAAEA;AAFJ,eAAD,CAAP;AAIAjB,qBAAO;AACV;AACJ,WApCD;AAqCAF,eAAK,CAACgC,KAAN;AACH;;;wCACezC,K,EAAOhB,O,EAAS;AAC5B,iBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,gBAAM2C,MAAM,GAAG,IAAIC,UAAJ,EAAf;AACA,gBAAMH,MAAM,GAAG5B,KAAK,CAACe,IAAN,CAAWoB,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAAf;;AACA,gBAAInD,OAAO,CAAC6C,UAAR,KAAuB,KAA3B,EAAkC;AAC9B3C,qBAAO,CAAC;AACJoD,uBAAO,EAAEC,GAAG,CAACC,eAAJ,CAAoBxC,KAApB,CADL;AAEJ4B,sBAAM,EAAEA;AAFJ,eAAD,CAAP;AAIH,aALD,MAMK;AACDE,oBAAM,CAACO,aAAP,CAAqBrC,KAArB;;AACA8B,oBAAM,CAACY,SAAP,GAAmB,YAAM;AACrB,oBAAMC,CAAC,GAAGb,MAAM,CAACG,MAAjB;;AACA,oBAAIjD,OAAO,CAAC6C,UAAR,KAAuB,SAA3B,EAAsC;AAClC3C,yBAAO,CAAC;AACJ8C,2BAAO,EAAEW,CADL;AAEJf,0BAAM,EAAEA;AAFJ,mBAAD,CAAP;AAIH,iBALD,MAMK;AACD1C,yBAAO,CAAC;AACJkD,gCAAY,EAAEO,CAAC,CAACR,KAAF,CAAQ,GAAR,EAAa,CAAb,CADV;AAEJP,0BAAM,EAAEA;AAFJ,mBAAD,CAAP;AAIH;AACJ,eAdD;;AAeAE,oBAAM,CAACc,OAAP,GAAiB,UAAA7C,CAAC,EAAI;AAClBZ,sBAAM,CAACY,CAAD,CAAN;AACH,eAFD;AAGH;AACJ,WA9BM,CAAP;AA+BH;;;;;;;;;;0BAEO,OAAO8C,SAAP,KAAqB,WAArB,IAAoC,CAACA,SAAS,CAACC,W;;;;;0BACzC,KAAKC,WAAL,CAAiB,+CAAjB,C;;;;;2BAMmBC,MAAM,CAACH,SAAP,CAAiBC,WAAjB,CAA6BG,KAA7B,CAAmC;AACxDC,0BAAI,EAAE;AADkD,qBAAnC,C;;;AAAnBC,8B;sDAGC;AACHC,4BAAM,EAAED,UAAU,CAACE,KADhB;AAEHC,4BAAM,EAAE;AAFL,qB;;;;;0BAMD,KAAKP,WAAL,CAAiB,sDAAjB,C;;;;;;;;;;;;;;;;;;;;;;;;0BAIJ,KAAKQ,aAAL,CAAmB,yBAAnB,C;;;;;;;;;;;;;;;;;;;MA7JiB,yD;;AAgK/B,QAAMC,MAAM,GAAG,IAAIzE,SAAJ,EAAf,C,CAEA","file":"web-es5.js","sourcesContent":["import { WebPlugin, CapacitorException } from '@capacitor/core';\nimport { CameraSource, CameraDirection } from './definitions';\nexport class CameraWeb extends WebPlugin {\n    async getPhoto(options) {\n        // eslint-disable-next-line no-async-promise-executor\n        return new Promise(async (resolve, reject) => {\n            if (options.webUseInput) {\n                this.fileInputExperience(options, resolve);\n            }\n            else {\n                if (customElements.get('pwa-camera-modal')) {\n                    const cameraModal = document.createElement('pwa-camera-modal');\n                    document.body.appendChild(cameraModal);\n                    try {\n                        await cameraModal.componentOnReady();\n                        cameraModal.addEventListener('onPhoto', async (e) => {\n                            const photo = e.detail;\n                            if (photo === null) {\n                                reject(new CapacitorException('User cancelled photos app'));\n                            }\n                            else if (photo instanceof Error) {\n                                reject(photo);\n                            }\n                            else {\n                                resolve(await this._getCameraPhoto(photo, options));\n                            }\n                            cameraModal.dismiss();\n                            document.body.removeChild(cameraModal);\n                        });\n                        cameraModal.present();\n                    }\n                    catch (e) {\n                        this.fileInputExperience(options, resolve);\n                    }\n                }\n                else {\n                    console.error(`Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements.`);\n                    this.fileInputExperience(options, resolve);\n                }\n            }\n        });\n    }\n    fileInputExperience(options, resolve) {\n        let input = document.querySelector('#_capacitor-camera-input');\n        const cleanup = () => {\n            var _a;\n            (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n        };\n        if (!input) {\n            input = document.createElement('input');\n            input.id = '_capacitor-camera-input';\n            input.type = 'file';\n            document.body.appendChild(input);\n        }\n        input.accept = 'image/*';\n        input.capture = true;\n        if (options.source === CameraSource.Photos ||\n            options.source === CameraSource.Prompt) {\n            input.removeAttribute('capture');\n        }\n        else if (options.direction === CameraDirection.Front) {\n            input.capture = 'user';\n        }\n        else if (options.direction === CameraDirection.Rear) {\n            input.capture = 'environment';\n        }\n        input.addEventListener('change', (_e) => {\n            const file = input.files[0];\n            let format = 'jpeg';\n            if (file.type === 'image/png') {\n                format = 'png';\n            }\n            else if (file.type === 'image/gif') {\n                format = 'gif';\n            }\n            if (options.resultType === 'dataUrl' || options.resultType === 'base64') {\n                const reader = new FileReader();\n                reader.addEventListener('load', () => {\n                    if (options.resultType === 'dataUrl') {\n                        resolve({\n                            dataUrl: reader.result,\n                            format,\n                        });\n                    }\n                    else if (options.resultType === 'base64') {\n                        const b64 = reader.result.split(',')[1];\n                        resolve({\n                            base64String: b64,\n                            format,\n                        });\n                    }\n                    cleanup();\n                });\n                reader.readAsDataURL(file);\n            }\n            else {\n                resolve({\n                    webPath: URL.createObjectURL(file),\n                    format: format,\n                });\n                cleanup();\n            }\n        });\n        input.click();\n    }\n    _getCameraPhoto(photo, options) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            const format = photo.type.split('/')[1];\n            if (options.resultType === 'uri') {\n                resolve({\n                    webPath: URL.createObjectURL(photo),\n                    format: format,\n                });\n            }\n            else {\n                reader.readAsDataURL(photo);\n                reader.onloadend = () => {\n                    const r = reader.result;\n                    if (options.resultType === 'dataUrl') {\n                        resolve({\n                            dataUrl: r,\n                            format: format,\n                        });\n                    }\n                    else {\n                        resolve({\n                            base64String: r.split(',')[1],\n                            format: format,\n                        });\n                    }\n                };\n                reader.onerror = e => {\n                    reject(e);\n                };\n            }\n        });\n    }\n    async checkPermissions() {\n        if (typeof navigator === 'undefined' || !navigator.permissions) {\n            throw this.unavailable('Permissions API not available in this browser');\n        }\n        try {\n            // https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query\n            // the specific permissions that are supported varies among browsers that implement the\n            // permissions API, so we need a try/catch in case 'camera' is invalid\n            const permission = await window.navigator.permissions.query({\n                name: 'camera',\n            });\n            return {\n                camera: permission.state,\n                photos: 'granted',\n            };\n        }\n        catch (_a) {\n            throw this.unavailable('Camera permissions are not available in this browser');\n        }\n    }\n    async requestPermissions() {\n        throw this.unimplemented('Not implemented on web.');\n    }\n}\nconst Camera = new CameraWeb();\nexport { Camera };\n//# sourceMappingURL=web.js.map"]}