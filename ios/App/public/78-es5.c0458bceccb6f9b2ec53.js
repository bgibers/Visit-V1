function asyncGeneratorStep(e,t,n,r,o,s,i){try{var c=e[s](i),a=c.value}catch(u){return void n(u)}c.done?t(a):Promise.resolve(a).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function i(e){asyncGeneratorStep(s,r,o,i,c,"next",e)}function c(e){asyncGeneratorStep(s,r,o,i,c,"throw",e)}i(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{affe:function(e,t,n){"use strict";n.r(t),n.d(t,"NewsFeedPageModule",(function(){return b}));var r=n("TEn/"),o=n("tyNb"),s=n("ofXK"),i=n("3Pt+"),c=n("ykzJ"),a=n("su2D"),u=n("5HCe"),l=n("MCRb"),p=n("IzEk"),f=n("sbzx"),h=n("fXoL"),g=n("e8h1"),d=n("YzH7"),m=function(){function e(t,n,r,o,s,i,c,a,u){var l=this;_classCallCheck(this,e),this.storage=t,this.modalController=n,this.zone=r,this.cd=o,this.loadingController=s,this.accountService=i,this.postService=c,this.router=a,this.analyticsSvc=u,this.posts=[],this.pageNumber=1,this.morePages=!1,this.filter="",this.selectedUserId="",this.storage.get("image").then((function(e){e?(l.image=e,l.cd.detectChanges()):l.image="../../../assets/defaultuser.png"})),this.analyticsSvc.enableAnalytics(),this.analyticsSvc.setUser()}var t,n,r,o;return _createClass(e,[{key:"ionViewDidEnter",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingController.create();case 2:return t=e.sent,e.next=5,t.present();case 5:console.log("".concat(this.pageNumber,", ").concat(this.filter,", ").concat(this.selectedUserId)),this.postService.postsPageGet(this.pageNumber,this.filter,this.selectedUserId).pipe(Object(p.a)(1)).subscribe(function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.morePages=r.hasNextPage,n.pageNumber=r.pageIndex,n.posts=r.items,n.refresh(),e.next=6,n.getPosts(1);case 6:t.dismiss();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=401===r.status,!e.t0){e.next=5;break}return t.dismiss(),e.next=5,n.accountService.logout();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"ionViewWillLeave",value:function(){this.pageNumber=1,this.morePages=!1}},{key:"getPosts",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){r.morePages?r.postService.postsPageGet(r.pageNumber+t,r.filter,r.selectedUserId).pipe(Object(p.a)(1)).subscribe((function(t){if(r.morePages=t.hasNextPage,r.pageNumber=t.pageIndex,0===r.posts.length)r.posts=[];else{var o=r.posts;r.posts=[];for(var s=o.length,i=0;i<s;i++)r.posts.push(o[i])}for(var c=t.items.length,a=0;a<c;a++)r.posts.push(t.items[a]);n&&n.target.complete(),r.refresh(),e("done")}),function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(n),t.t0=401===n.status,!t.t0){t.next=6;break}return t.next=5,r.accountService.logout();case 5:e("done");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):(e("done"),r.infiniteScroll.disabled=!r.infiniteScroll.disabled)})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"refreshPosts",value:function(e){var t=this;this.postService.postsPageGet(1,this.filter,this.selectedUserId).pipe(Object(p.a)(1)).subscribe((function(n){t.morePages=n.hasNextPage,t.pageNumber=n.pageIndex,t.posts=n.items,e&&e.target.complete()}),function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(n),e.t0=401===n.status,!e.t0){e.next=5;break}return e.next=5,t.accountService.logout();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"presentSearchModal",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:c.a,componentProps:{},showBackdrop:!0,cssClass:"search-modal"});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"openProfile",value:function(){var e=this,t={replaceUrl:!0,skipLocationChange:!0,state:{userId:this.accountService.getUserId()}};this.zone.run((function(){e.router.navigateByUrl("/user-profile",t)}))}},{key:"presentMapFilter",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:a.a,showBackdrop:!0,cssClass:"filter-modal",componentProps:{filter:this.filter}});case 2:return(t=e.sent).onDidDismiss().then(function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadingController.create();case 2:null!==t?(n.filter=t.data,n.refreshPosts(),n.refresh()):n.refresh();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"refresh",value:function(){this.cd.detectChanges()}}]),e}();m.\u0275fac=function(e){return new(e||m)(h.cc(g.b),h.cc(r.V),h.cc(h.L),h.cc(h.j),h.cc(r.U),h.cc(u.a),h.cc(l.b),h.cc(o.g),h.cc(f.a))},m.\u0275cmp=h.Wb({type:m,selectors:[["news-feed"]],viewQuery:function(e,t){var n;1&e&&h.Oc(r.u,!0),2&e&&h.Dc(n=h.qc())&&(t.infiniteScroll=n.first)},decls:25,vars:3,consts:[[2,"background-color","#128c7e"],["color","#128C7E"],[1,"header-grid"],[1,"ion-align-items-baseline"],[1,"ion-justify-content-start"],[1,"ion-justify-content-start","circle-pic",3,"click"],[3,"src"],[1,"ion-justify-self-bottom"],["height","60px","width","120px","src","../../assets/logos/whiteLogo.png"],[1,"ion-justify-content-end"],[1,"ion-justify-content-end",3,"click"],["src","../../assets/UI/search-outline.svg",1,"img-center"],["color","light",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["refresherRef",""],["pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],[3,"posts"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","circles","loadingText","Getting more posts..."],["vertical","bottom",1,"map-filter-fab"],["fill","clear",3,"click"],["src","../../assets/UI/FilterClosed.svg"]],template:function(e,t){1&e&&(h.hc(0,"ion-header",0),h.hc(1,"ion-toolbar",1),h.hc(2,"ion-grid",2),h.hc(3,"ion-row",3),h.hc(4,"ion-col",4),h.hc(5,"ion-buttons",4),h.hc(6,"ion-button",5),h.pc("click",(function(){return t.openProfile()})),h.hc(7,"ion-avatar"),h.dc(8,"img",6),h.gc(),h.gc(),h.gc(),h.gc(),h.hc(9,"ion-col",7),h.dc(10,"img",8),h.gc(),h.hc(11,"ion-col",9),h.hc(12,"ion-buttons",9),h.hc(13,"ion-button",10),h.pc("click",(function(){return t.presentSearchModal()})),h.dc(14,"img",11),h.gc(),h.gc(),h.gc(),h.gc(),h.gc(),h.gc(),h.gc(),h.hc(15,"ion-content",12),h.hc(16,"ion-refresher",13,14),h.pc("ionRefresh",(function(e){return t.refreshPosts(e)})),h.dc(18,"ion-refresher-content",15),h.gc(),h.dc(19,"post",16),h.hc(20,"ion-infinite-scroll",17),h.pc("ionInfinite",(function(e){return t.getPosts(1,e)})),h.dc(21,"ion-infinite-scroll-content",18),h.gc(),h.gc(),h.hc(22,"ion-fab",19),h.hc(23,"ion-button",20),h.pc("click",(function(){return t.presentMapFilter()})),h.dc(24,"img",21),h.gc(),h.gc()),2&e&&(h.Rb(8),h.zc("src",t.image,h.Gc),h.Rb(7),h.yc("fullscreen",!1),h.Rb(4),h.yc("posts",t.posts))},directives:[r.s,r.Q,r.r,r.G,r.l,r.g,r.f,r.c,r.m,r.D,r.E,d.a,r.u,r.v,r.o],styles:["ion-content[_ngcontent-%COMP%]{--background:translucent}ion-toolbar[_ngcontent-%COMP%]{--min-height:2%!important;--padding-top:10px}.circle-pic[_ngcontent-%COMP%]{width:65px;height:50px;border-radius:50%}.center[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;display:block}.post-pic[_ngcontent-%COMP%]{--border-radius:75%}.card-title[_ngcontent-%COMP%]{font-size:20px;font-weight:400;padding-bottom:5px}.header-grid[_ngcontent-%COMP%]{--ion-grid-columns:3;--ion-grid-column-padding:1px;--ion-grid-padding:1px}.map-filter[_ngcontent-%COMP%], .map-filter-fab[_ngcontent-%COMP%]{justify-content:center;align-self:center}.btn[_ngcontent-%COMP%]{border:none;background-color:inherit;font-size:16px;display:inline-block}.comment[_ngcontent-%COMP%]{--padding-start:0px;--inner-padding-end:0px;--padding-bottom:0px}"]});var v=n("PCNd"),b=function e(){_classCallCheck(this,e)};b.\u0275mod=h.ac({type:b}),b.\u0275inj=h.Zb({factory:function(e){return new(e||b)},imports:[[r.S,s.c,i.g,v.a,o.k.forChild([{path:"",component:m}])]]})}}]);