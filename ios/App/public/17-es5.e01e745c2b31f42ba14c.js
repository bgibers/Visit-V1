function asyncGeneratorStep(e,t,n,r,o,s,i){try{var a=e[s](i),c=a.value}catch(u){return void n(u)}a.done?t(c):Promise.resolve(c).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function i(e){asyncGeneratorStep(s,r,o,i,a,"next",e)}function a(e){asyncGeneratorStep(s,r,o,i,a,"throw",e)}i(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{affe:function(e,t,n){"use strict";n.r(t),n.d(t,"NewsFeedPageModule",(function(){return y}));var r,o,s=n("TEn/"),i=n("tyNb"),a=n("ofXK"),c=n("3Pt+"),u=n("ykzJ"),l=n("su2D"),p=n("5HCe"),f=n("MCRb"),h=n("IzEk"),g=n("sbzx"),b=n("fXoL"),d=n("e8h1"),m=n("YzH7"),v=((r=function(){function e(t,n,r,o,s,i,a,c,u){var l=this;_classCallCheck(this,e),this.storage=t,this.modalController=n,this.zone=r,this.cd=o,this.loadingController=s,this.accountService=i,this.postService=a,this.router=c,this.analyticsSvc=u,this.posts=[],this.pageNumber=1,this.morePages=!1,this.filter="",this.selectedUserId="",this.storage.get("image").then((function(e){e?(l.image=e,l.cd.detectChanges()):l.image="../../../assets/defaultuser.png"})),this.analyticsSvc.enableAnalytics(),this.analyticsSvc.setUser()}var t,n,r,o;return _createClass(e,[{key:"ionViewWillEnter",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingController.create();case 2:return t=e.sent,e.next=5,t.present();case 5:this.postService.postsPageGet(this.pageNumber,this.filter,this.selectedUserId).pipe(Object(h.a)(1)).subscribe(function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.morePages=r.hasNextPage,n.pageNumber=r.pageIndex,n.posts=r.items,n.refresh(),e.next=6,n.getPosts(1);case 6:t.dismiss();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=401===t.status,!e.t0){e.next=4;break}return e.next=4,n.accountService.logout();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"ionViewWillLeave",value:function(){this.pageNumber=1,this.morePages=!1}},{key:"getPosts",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){r.morePages?r.postService.postsPageGet(r.pageNumber+t,r.filter,r.selectedUserId).pipe(Object(h.a)(1)).subscribe((function(t){if(r.morePages=t.hasNextPage,r.pageNumber=t.pageIndex,0===r.posts.length)r.posts=[];else{var o=r.posts;r.posts=[];for(var s=o.length,i=0;i<s;i++)r.posts.push(o[i])}for(var a=t.items.length,c=0;c<a;c++)r.posts.push(t.items[c]);n&&n.target.complete(),r.refresh(),e("done")}),function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(n),t.t0=401===n.status,!t.t0){t.next=6;break}return t.next=5,r.accountService.logout();case 5:e("done");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):(e("done"),r.infiniteScroll.disabled=!r.infiniteScroll.disabled)})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"refreshPosts",value:function(e){var t=this;this.postService.postsPageGet(1,this.filter,this.selectedUserId).pipe(Object(h.a)(1)).subscribe((function(n){t.morePages=n.hasNextPage,t.pageNumber=n.pageIndex,t.posts=n.items,e&&e.target.complete()}),function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(n),e.t0=401===n.status,!e.t0){e.next=5;break}return e.next=5,t.accountService.logout();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"presentSearchModal",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:u.a,componentProps:{},showBackdrop:!0,cssClass:"search-modal"});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"openProfile",value:function(){var e=this,t={replaceUrl:!0,skipLocationChange:!0,state:{userId:this.accountService.getUserId()}};this.zone.run((function(){e.router.navigateByUrl("/user-profile",t)}))}},{key:"presentMapFilter",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:l.a,showBackdrop:!0,cssClass:"filter-modal",componentProps:{filter:this.filter}});case 2:return(t=e.sent).onDidDismiss().then(function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadingController.create();case 2:return r=e.sent,e.next=5,r.present();case 5:if(null===t){e.next=13;break}return n.filter=t.data,n.refreshPosts(),n.refresh(),e.next=11,r.dismiss();case 11:e.next=14;break;case 13:n.refreshPosts();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=6,t.present();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"refresh",value:function(){this.cd.detectChanges()}}]),e}()).\u0275fac=function(e){return new(e||r)(b.Lb(d.b),b.Lb(s.V),b.Lb(b.z),b.Lb(b.h),b.Lb(s.U),b.Lb(p.a),b.Lb(f.b),b.Lb(i.g),b.Lb(g.a))},r.\u0275cmp=b.Fb({type:r,selectors:[["news-feed"]],viewQuery:function(e,t){var n;1&e&&b.xc(s.u,!0),2&e&&b.mc(n=b.Zb())&&(t.infiniteScroll=n.first)},decls:25,vars:3,consts:[[2,"background-color","#128c7e"],["color","#128C7E"],[1,"header-grid"],[1,"ion-align-items-baseline"],[1,"ion-justify-content-start"],[1,"ion-justify-content-start","circle-pic",3,"click"],[3,"src"],[1,"ion-justify-self-bottom"],["height","60px","width","120px","src","../../assets/logos/whiteLogo.png"],[1,"ion-justify-content-end"],[1,"ion-justify-content-end",3,"click"],["src","../../assets/UI/search-outline.svg",1,"img-center"],["color","light",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["refresherRef",""],["pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],[3,"posts"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","circles","loadingText","Getting more posts..."],["vertical","bottom",1,"map-filter-fab"],["fill","clear",3,"click"],["src","../../assets/UI/FilterClosed.svg"]],template:function(e,t){1&e&&(b.Qb(0,"ion-header",0),b.Qb(1,"ion-toolbar",1),b.Qb(2,"ion-grid",2),b.Qb(3,"ion-row",3),b.Qb(4,"ion-col",4),b.Qb(5,"ion-buttons",4),b.Qb(6,"ion-button",5),b.Yb("click",(function(){return t.openProfile()})),b.Qb(7,"ion-avatar"),b.Mb(8,"img",6),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Qb(9,"ion-col",7),b.Mb(10,"img",8),b.Pb(),b.Qb(11,"ion-col",9),b.Qb(12,"ion-buttons",9),b.Qb(13,"ion-button",10),b.Yb("click",(function(){return t.presentSearchModal()})),b.Mb(14,"img",11),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Qb(15,"ion-content",12),b.Qb(16,"ion-refresher",13,14),b.Yb("ionRefresh",(function(e){return t.refreshPosts(e)})),b.Mb(18,"ion-refresher-content",15),b.Pb(),b.Mb(19,"post",16),b.Qb(20,"ion-infinite-scroll",17),b.Yb("ionInfinite",(function(e){return t.getPosts(1,e)})),b.Mb(21,"ion-infinite-scroll-content",18),b.Pb(),b.Pb(),b.Qb(22,"ion-fab",19),b.Qb(23,"ion-button",20),b.Yb("click",(function(){return t.presentMapFilter()})),b.Mb(24,"img",21),b.Pb(),b.Pb()),2&e&&(b.Ab(8),b.ic("src",t.image,b.pc),b.Ab(7),b.hc("fullscreen",!1),b.Ab(4),b.hc("posts",t.posts))},directives:[s.s,s.Q,s.r,s.G,s.l,s.g,s.f,s.c,s.m,s.D,s.E,m.a,s.u,s.v,s.o],styles:["ion-content[_ngcontent-%COMP%]{--background:translucent}ion-toolbar[_ngcontent-%COMP%]{--min-height:2%!important;--padding-top:10px}.circle-pic[_ngcontent-%COMP%]{width:65px;height:50px;border-radius:50%}.center[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;display:block}.post-pic[_ngcontent-%COMP%]{--border-radius:75%}.card-title[_ngcontent-%COMP%]{font-size:20px;font-weight:400;padding-bottom:5px}.header-grid[_ngcontent-%COMP%]{--ion-grid-columns:3;--ion-grid-column-padding:1px;--ion-grid-padding:1px}.map-filter[_ngcontent-%COMP%], .map-filter-fab[_ngcontent-%COMP%]{justify-content:center;align-self:center}.btn[_ngcontent-%COMP%]{border:none;background-color:inherit;font-size:16px;display:inline-block}.comment[_ngcontent-%COMP%]{--padding-start:0px;--inner-padding-end:0px;--padding-bottom:0px}"]}),r),P=n("PCNd"),y=((o=function e(){_classCallCheck(this,e)}).\u0275mod=b.Jb({type:o}),o.\u0275inj=b.Ib({factory:function(e){return new(e||o)},imports:[[s.S,a.c,c.g,P.a,i.k.forChild([{path:"",component:v}])]]}),o)}}]);